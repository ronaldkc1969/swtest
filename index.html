<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>社会福祉士 国家試験対策クイズ</title>
    <style>
        body { font-family: sans-serif; line-height: 1.6; max-width: 800px; margin: 0 auto; padding: 20px; background-color: #f4f7f6; }
        .card { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .hidden { display: none; }
        button { background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 5px; }
        button:hover { background: #0056b3; }
        .option-btn { display: block; width: 100%; text-align: left; background: #f8f9fa; color: #333; border: 1px solid #ddd; }
        .option-btn:hover { background: #e2e6ea; }
        .correct { background: #d4edda !important; border-color: #c3e6cb; }
        .incorrect { background: #f8d7da !important; border-color: #f5c6cb; }
        .explanation { background: #e2f3ff; padding: 15px; border-left: 5px solid #007bff; margin-top: 10px; }
    </style>
</head>
<body>

    <h1>社会福祉士 国家試験対策</h1>

    <div id="category-screen" class="card">
        <h2>学習する分野を選択してください</h2>
        <div id="category-list"></div>
    </div>

    <div id="quiz-screen" class="card hidden">
        <div id="progress"></div>
        <h3 id="question-text"></h3>
        <div id="options-container"></div>
        <div id="feedback" class="hidden">
            <p id="result-message"></p>
            <div class="explanation">
                <strong>解説:</strong> <span id="explanation-text"></span>
            </div>
            <button onclick="nextQuestion()">次の問題へ</button>
        </div>
    </div>

    <div id="result-screen" class="card hidden">
        <h2>結果発表</h2>
        <p id="score-summary"></p>
        <div id="review-container"></div>
        <button onclick="location.reload()">分野選択に戻る</button>
    </div>

    <script>
        // 問題データ（実際にはここを19分野分、各30問に拡充します）
        const quizData = {
            "人体の構造と機能及び疾病": [
                { q: "国際生活機能分類（ICF）において、「活動」の定義として正しいものはどれか。", options: ["身体系のはたらき", "生活・人生場面への関わり", "課題や生活の遂行", "身体の解剖学的部分"], answer: 2, exp: "「活動」は課題や行為の個人による遂行を指します。「参加」は生活場面への関わりです。" },
                { q: "リハビリテーションの概念について、正しいものはどれか。", options: ["単なる機能回復訓練である", "全人間的復権を目指す", "高齢者のみが対象である", "医療分野に限定される"], answer: 1, exp: "現代のリハビリテーションは、障害者の全人間的復権（権利の回復）を目的とします。" }
            ],
            "心理学的支援": [
                { q: "ピアジェの発達段階において、自己中心性が特徴的な時期はどれか。", options: ["感覚運動期", "前操作期", "具体的操作期", "形式的操作期"], answer: 1, exp: "前操作期（2〜7歳頃）は、自己中心的な思考が特徴です。" }
            ],
            "社会理論と社会システム": [
                { q: "「ゲマインシャフト」と「ゲゼルシャフト」を提唱した人物は誰か。", options: ["デュルケム", "ウェーバー", "テンニース", "パースンズ"], answer: 2, exp: "テンニースは、地縁・血縁などの共同社会（ゲマインシャフト）と、利益追求の利益社会（ゲゼルシャフト）を区別しました。" }
            ]
        };

        let currentCategory = "";
        let questions = [];
        let currentIndex = 0;
        let score = 0;
        let wrongQuestions = [];

        // カテゴリボタンの生成
        const categoryList = document.getElementById('category-list');
        Object.keys(quizData).forEach(cat => {
            const btn = document.createElement('button');
            btn.innerText = cat;
            btn.onclick = () => startQuiz(cat);
            categoryList.appendChild(btn);
        });

        function startQuiz(category) {
            currentCategory = category;
            // データをコピーしてシャッフル（実際はここで30問抽出）
            questions = [...quizData[category]].sort(() => Math.random() - 0.5);
            currentIndex = 0;
            score = 0;
            wrongQuestions = [];
            
            document.getElementById('category-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            showQuestion();
        }

        function showQuestion() {
            const q = questions[currentIndex];
            document.getElementById('progress').innerText = `問題 ${currentIndex + 1} / ${questions.length}`;
            document.getElementById('question-text').innerText = q.q;
            document.getElementById('feedback').classList.add('hidden');
            
            const container = document.getElementById('options-container');
            container.innerHTML = "";
            q.options.forEach((opt, i) => {
                const btn = document.createElement('button');
                btn.className = "option-btn";
                btn.innerText = `${i + 1}. ${opt}`;
                btn.onclick = () => checkAnswer(i);
                container.appendChild(btn);
            });
        }

        function checkAnswer(selected) {
            const q = questions[currentIndex];
            const btns = document.querySelectorAll('.option-btn');
            
            btns.forEach(btn => btn.disabled = true);
            
            if (selected === q.answer) {
                btns[selected].classList.add('correct');
                document.getElementById('result-message').innerText = "⭕ 正解！";
                score++;
            } else {
                btns[selected].classList.add('incorrect');
                btns[q.answer].classList.add('correct');
                document.getElementById('result-message').innerText = "❌ 不正解...";
                wrongQuestions.push(q);
            }

            document.getElementById('explanation-text').innerText = q.exp;
            document.getElementById('feedback').classList.remove('hidden');
        }

        function nextQuestion() {
            currentIndex++;
            if (currentIndex < questions.length) {
                showQuestion();
            } else {
                showResult();
            }
        }

        function showResult() {
            document.getElementById('quiz-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            document.getElementById('score-summary').innerText = `${questions.length}問中 ${score}問正解でした。`;

            const reviewContainer = document.getElementById('review-container');
            reviewContainer.innerHTML = "<h3>間違えた問題の復習:</h3>";
            
            if (wrongQuestions.length === 0) {
                reviewContainer.innerHTML += "<p>全問正解です！素晴らしい！</p>";
            } else {
                wrongQuestions.forEach((q, i) => {
                    const div = document.createElement('div');
                    div.className = "card";
                    div.innerHTML = `<strong>問: ${q.q}</strong><br>正解: ${q.options[q.answer]}<br><small>${q.exp}</small>`;
                    reviewContainer.appendChild(div);
                });
            }
        }
    </script>
</body>
</html>
